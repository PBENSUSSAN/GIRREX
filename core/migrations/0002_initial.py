# Generated by Django 5.2.4 on 2025-07-30 18:34

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):
    initial = True

    dependencies = [
        ("auth", "0012_alter_user_first_name_max_length"),
        ("core", "0001_initial"),
        ("documentation", "0001_initial"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name="actionqs",
            name="document",
            field=models.ForeignKey(
                blank=True,
                help_text="Lien vers un document si l'action est documentaire",
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                to="documentation.document",
            ),
        ),
        migrations.AddField(
            model_name="agent",
            name="user",
            field=models.OneToOneField(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.CASCADE,
                related_name="agent_profile",
                to=settings.AUTH_USER_MODEL,
                verbose_name="Compte utilisateur associé",
            ),
        ),
        migrations.AddField(
            model_name="affectation",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="affectations",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="activitezone",
            name="agent_action",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                to="core.agent",
                verbose_name="Agent ayant effectué l'action",
            ),
        ),
        migrations.AddField(
            model_name="agentrole",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="roles_assignes",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="auditheurescontrole",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="audits_heures",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="auditqs",
            name="auditeur",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT, to="core.agent"
            ),
        ),
        migrations.AddField(
            model_name="auditqs",
            name="document",
            field=models.ForeignKey(
                blank=True,
                help_text="Lien vers le rapport d'audit complet",
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                to="documentation.document",
            ),
        ),
        migrations.AddField(
            model_name="categorieevenement",
            name="centre",
            field=models.ForeignKey(
                help_text="Centre auquel cette catégorie est rattachée.",
                on_delete=django.db.models.deletion.CASCADE,
                related_name="categories_evenements",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="auditqs",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="audits_recus",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="agentrole",
            name="centre",
            field=models.ForeignKey(
                blank=True,
                help_text="Obligatoire si le rôle est local ou opérationnel.",
                null=True,
                on_delete=django.db.models.deletion.CASCADE,
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="agent",
            name="centre",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="agents",
                to="core.centre",
                verbose_name="Centre de rattachement",
            ),
        ),
        migrations.AddField(
            model_name="affectation",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="affectations_personnel",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="centrerole",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE, to="core.agent"
            ),
        ),
        migrations.AddField(
            model_name="centrerole",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE, to="core.centre"
            ),
        ),
        migrations.AddField(
            model_name="certificatmed",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="certificats_medicaux",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="action",
            name="changement",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="actions",
                to="core.changement",
            ),
        ),
        migrations.AddField(
            model_name="controlevol",
            name="controleur",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="vols_controles",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="delegation",
            name="creee_par",
            field=models.ForeignKey(
                help_text="Utilisateur qui a enregistré cette délégation.",
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="delegations_creees",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="delegation",
            name="delegant",
            field=models.ForeignKey(
                help_text="L'agent qui donne ses droits.",
                on_delete=django.db.models.deletion.CASCADE,
                related_name="delegations_donnees",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="delegation",
            name="delegataire",
            field=models.ForeignKey(
                help_text="L'agent qui reçoit les droits (l'intérimaire).",
                on_delete=django.db.models.deletion.CASCADE,
                related_name="delegations_recues",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="evaluation",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="evaluations",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="evaluationrisqueqs",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT, to="core.centre"
            ),
        ),
        migrations.AddField(
            model_name="evenementcentre",
            name="auteur",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="evenements_consignes",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="evenementcentre",
            name="categorie",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="evenements",
                to="core.categorieevenement",
                verbose_name="Catégorie",
            ),
        ),
        migrations.AddField(
            model_name="evenementcentre",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="evenements",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="evenementqs",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT, to="core.centre"
            ),
        ),
        migrations.AddField(
            model_name="evenementqs",
            name="rapporteur",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="evenements_rapportes_qs",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="feuilletempsentree",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="pointages",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="feuilletempsentree",
            name="modifie_par",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="formation",
            name="agent",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.CASCADE,
                related_name="formations",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="actionqs",
            name="formation",
            field=models.ForeignKey(
                blank=True,
                help_text="Lien vers une formation si l'action en est une",
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                to="core.formation",
            ),
        ),
        migrations.AddField(
            model_name="habilitation",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="habilitations",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="licence",
            name="agent",
            field=models.ForeignKey(
                help_text="Agent détenteur de la licence",
                on_delete=django.db.models.deletion.CASCADE,
                related_name="licences",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="mention",
            name="licence",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="mentions",
                to="core.licence",
            ),
        ),
        migrations.AddField(
            model_name="formation",
            name="module",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="sessions_formation",
                to="core.module",
            ),
        ),
        migrations.AddField(
            model_name="changement",
            name="mrr",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="changements",
                to="core.mrr",
            ),
        ),
        migrations.AddField(
            model_name="mrrprogression",
            name="mrr",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="progression",
                to="core.mrr",
            ),
        ),
        migrations.AddField(
            model_name="mrrsignataire",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT, to="core.agent"
            ),
        ),
        migrations.AddField(
            model_name="mrrsignataire",
            name="mrr",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="signataires",
                to="core.mrr",
            ),
        ),
        migrations.AddField(
            model_name="notification",
            name="action",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="notifications",
                to="core.action",
            ),
        ),
        migrations.AddField(
            model_name="notificationqs",
            name="action",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="notifications_qs",
                to="core.actionqs",
            ),
        ),
        migrations.AddField(
            model_name="formation",
            name="organisme",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="formations_dispensees",
                to="core.organisme",
            ),
        ),
        migrations.AddField(
            model_name="pannecentre",
            name="auteur",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="pannes_consignees",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="pannecentre",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="pannes",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="positionjour",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="positions_jour",
                to="core.centre",
                verbose_name="Centre associé",
            ),
        ),
        migrations.AddField(
            model_name="qualification",
            name="licence",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="qualifications",
                to="core.licence",
            ),
        ),
        migrations.AddField(
            model_name="recommendationqs",
            name="centres_cibles",
            field=models.ManyToManyField(
                blank=True, related_name="recommandations_qs_cibles", to="core.centre"
            ),
        ),
        migrations.AddField(
            model_name="recommendationqs",
            name="evenement",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="recommandations",
                to="core.evenementqs",
            ),
        ),
        migrations.AddField(
            model_name="recommendationqs",
            name="responsable",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="recommandations_qs_responsable",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="actionqs",
            name="recommendation",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="actions_qs",
                to="core.recommendationqs",
            ),
        ),
        migrations.AddField(
            model_name="responsableqscentral",
            name="agent",
            field=models.OneToOneField(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="responsabilite_qs_central",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="responsablesms",
            name="agent",
            field=models.OneToOneField(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="responsabilite_sms",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="changement",
            name="responsable_sms",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT, to="core.responsablesms"
            ),
        ),
        migrations.AddField(
            model_name="role",
            name="groups",
            field=models.ManyToManyField(
                blank=True,
                help_text="Les ensembles de permissions techniques que ce rôle confère.",
                to="auth.group",
                verbose_name="Groupes de permissions associés",
            ),
        ),
        migrations.AddField(
            model_name="agentrole",
            name="role",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="agents_assignes",
                to="core.role",
            ),
        ),
        migrations.AddField(
            model_name="servicejournalier",
            name="cdq_cloture",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                related_name="services_clotures",
                to="core.agent",
                verbose_name="CDQ de clôture",
            ),
        ),
        migrations.AddField(
            model_name="servicejournalier",
            name="cdq_ouverture",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="services_ouverts",
                to="core.agent",
                verbose_name="CDQ d'ouverture",
            ),
        ),
        migrations.AddField(
            model_name="servicejournalier",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="services_journaliers",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="servicejournalier",
            name="cloture_par",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                related_name="journees_cloturees_trace",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="servicejournalier",
            name="ouvert_par",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="journees_initialisees",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="servicejournalier",
            name="vise_par",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.PROTECT,
                related_name="services_vises",
                to=settings.AUTH_USER_MODEL,
                verbose_name="Visé par",
            ),
        ),
        migrations.AddField(
            model_name="activitezone",
            name="service_journalier",
            field=models.ForeignKey(
                help_text="Lie l'activité au service journalier qui était ouvert.",
                on_delete=django.db.models.deletion.CASCADE,
                related_name="activites_zone_du_jour",
                to="core.servicejournalier",
            ),
        ),
        migrations.AddField(
            model_name="servicejournalierhistorique",
            name="agent_action",
            field=models.ForeignKey(
                default=1,
                on_delete=django.db.models.deletion.PROTECT,
                to="core.agent",
                verbose_name="Agent",
            ),
        ),
        migrations.AddField(
            model_name="servicejournalierhistorique",
            name="modifie_par",
            field=models.ForeignKey(
                default=1,
                on_delete=django.db.models.deletion.PROTECT,
                to=settings.AUTH_USER_MODEL,
                verbose_name="Utilisateur",
            ),
        ),
        migrations.AddField(
            model_name="servicejournalierhistorique",
            name="service_journalier",
            field=models.ForeignKey(
                default=1,
                on_delete=django.db.models.deletion.CASCADE,
                related_name="historique",
                to="core.servicejournalier",
            ),
        ),
        migrations.AddField(
            model_name="tourdeservice",
            name="agent",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="tours_de_service",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="tourdeservice",
            name="modifie_par",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="tourdeservice",
            name="position_apres_midi",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="affectations_apres_midi",
                to="core.positionjour",
            ),
        ),
        migrations.AddField(
            model_name="tourdeservice",
            name="position_matin",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="affectations_matin",
                to="core.positionjour",
            ),
        ),
        migrations.AddField(
            model_name="tourdeservicehistorique",
            name="agent",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="tourdeservicehistorique",
            name="modifie_par",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="historique_tours_modifies",
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="tourdeservicehistorique",
            name="position_apres_midi",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to="core.positionjour",
            ),
        ),
        migrations.AddField(
            model_name="tourdeservicehistorique",
            name="position_matin",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="+",
                to="core.positionjour",
            ),
        ),
        migrations.AddField(
            model_name="tourdeservicehistorique",
            name="tour_de_service_original",
            field=models.ForeignKey(
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="historique",
                to="core.tourdeservice",
            ),
        ),
        migrations.AddField(
            model_name="valeurparametre",
            name="centre",
            field=models.ForeignKey(
                blank=True,
                help_text="Si ce paramètre est spécifique à un centre",
                null=True,
                on_delete=django.db.models.deletion.CASCADE,
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="valeurparametre",
            name="parametre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="valeurs",
                to="core.parametre",
            ),
        ),
        migrations.AddField(
            model_name="valeurparametre",
            name="responsable",
            field=models.ForeignKey(
                help_text="Agent responsable de cette valeur",
                on_delete=django.db.models.deletion.PROTECT,
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="versiontourdeservice",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="versions_planning",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="versiontourdeservice",
            name="valide_par",
            field=models.ForeignKey(
                help_text="L'utilisateur qui a validé cette version.",
                on_delete=django.db.models.deletion.PROTECT,
                to=settings.AUTH_USER_MODEL,
            ),
        ),
        migrations.AddField(
            model_name="vol",
            name="cca",
            field=models.ForeignKey(
                help_text="Agent en charge de la coordination du vol (CCA)",
                on_delete=django.db.models.deletion.PROTECT,
                related_name="vols_en_charge_cca",
                to="core.agent",
            ),
        ),
        migrations.AddField(
            model_name="vol",
            name="centre",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="vols",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="vol",
            name="client",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.PROTECT,
                related_name="vols",
                to="core.client",
            ),
        ),
        migrations.AddField(
            model_name="controlevol",
            name="vol",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="prises_en_charge",
                to="core.vol",
            ),
        ),
        migrations.AddField(
            model_name="zone",
            name="centre",
            field=models.ForeignKey(
                help_text="Le centre auquel cette zone est rattachée.",
                on_delete=django.db.models.deletion.CASCADE,
                related_name="zones",
                to="core.centre",
            ),
        ),
        migrations.AddField(
            model_name="zone",
            name="dernier_agent",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.SET_NULL,
                related_name="zones_modifiees",
                to="core.agent",
                verbose_name="Dernier agent intervenu",
            ),
        ),
        migrations.AddField(
            model_name="activitezone",
            name="zone",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="historique_activites",
                to="core.zone",
            ),
        ),
        migrations.AlterUniqueTogether(
            name="auditheurescontrole",
            unique_together={("agent", "periode")},
        ),
        migrations.CreateModel(
            name="FeuilleTempsVerrou",
            fields=[
                (
                    "centre",
                    models.OneToOneField(
                        on_delete=django.db.models.deletion.CASCADE,
                        primary_key=True,
                        related_name="verrou_feuille_temps",
                        serialize=False,
                        to="core.centre",
                    ),
                ),
                ("verrouille_a", models.DateTimeField(auto_now_add=True)),
                (
                    "chef_de_quart",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE, to="core.agent"
                    ),
                ),
            ],
            options={
                "verbose_name": "Verrou d'édition de Feuille de Temps",
            },
        ),
        migrations.AlterUniqueTogether(
            name="categorieevenement",
            unique_together={("nom", "centre")},
        ),
        migrations.AlterUniqueTogether(
            name="feuilletempsentree",
            unique_together={("agent", "date_jour")},
        ),
        migrations.AlterUniqueTogether(
            name="mrrsignataire",
            unique_together={("mrr", "agent")},
        ),
        migrations.AlterUniqueTogether(
            name="positionjour",
            unique_together={("centre", "nom")},
        ),
        migrations.AlterUniqueTogether(
            name="agentrole",
            unique_together={("agent", "role", "centre", "date_debut")},
        ),
        migrations.AlterUniqueTogether(
            name="servicejournalier",
            unique_together={("centre", "date_jour")},
        ),
        migrations.AlterUniqueTogether(
            name="tourdeservice",
            unique_together={("agent", "date")},
        ),
        migrations.AlterUniqueTogether(
            name="valeurparametre",
            unique_together={("parametre", "centre")},
        ),
        migrations.AlterUniqueTogether(
            name="zone",
            unique_together={("centre", "nom")},
        ),
    ]
